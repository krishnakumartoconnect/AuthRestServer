using Fido2NetLib;

@model Fido2NetLib.RequestNewCredentialParams


<h2>Login with Your Device</h2>

<script>
    const publicKey = @Html.Raw(Json.Serialize(Model));
    navigator.credentials.get({ publicKey })
        .then(function (assertion) {
            var response = {
                id: assertion.id,
                rawId: assertion.rawId,
                response: {
                    authenticatorData: assertion.response.authenticatorData,
                    clientDataJSON: assertion.response.clientDataJSON,
                    signature: assertion.response.signature
                }
            };

            // Send response to the server
            fetch('/Home/CompleteAuthentication', {
                method: 'POST',
                body: JSON.stringify(response),
                headers: { 'Content-Type': 'application/json' }
            });
        })
        .catch(function (error) {
            console.log(error);
        });
</script>
